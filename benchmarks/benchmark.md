# Benchmark

## Ntt benchmark

### Test Environment:

* Date: 2020.06.28
* OS:  Win10 Pro 1903 (18362.418)
* CPU: [i9-9900K](https://en.wikichip.org/wiki/intel/core_i9/i9-9900k)
* Compiler: gcc version 10.1.0 (Rev3, Built by MSYS2 project)
* Msys2: msys2-x86_64-20200602
* Test code: [Ntt test](https://github.com/baihacker/pe/blob/master/test/ntt_test.c)
  * ntt_test.c is moved to poly_mul_test.c
* Build:
  * [Build and use third party library in pe](https://github.com/baihacker/pe/blob/master/libraries_on_win64.md#build-and-use-third-party-library-in-pe)
  * Build test target:
  > -o a.exe --std=c++17 -fno-diagnostics-color -O3 -march=native -mtune=native -fopenmp -Wl,--stack,268435456 -static -lbf -lgmpxx -lflint -lmpfr -lntl -lgmp

### Test result

#### Openmp enabled
```cpp
ntt test : data = random, size = 1, n = 1000000, mod = 100019
flint n  : 0.297
flint p  : 0.578
ntt32 s  : 0.828
ntt32 l  : 0.953
ntt64 s  : 1.312
ntt64 l  : 1.406
Min_25 s : 0.125
Min_25 l : 0.157
libbf    : 0.624
ntl      : 0.594
ntt test : data = random, size = 3, n = 1479725, mod = 100000000003
flint n  : 0.890
flint p  : 1.281
ntt32 l  : 1.796
ntt64 l  : 2.796
Min_25 l : 0.281
libbf    : 1.046
ntl      : 1.297
ntt test : data = random, size = 4, n = 1000000, mod = 316227766016779
flint n  : 0.609
flint p  : 0.859
ntt64 l  : 1.437
Min_25 l : 0.156
libbf    : 0.672
ntl      : 0.997
ntt test : data = max mod, size = 1, n = 999996, mod = 1000003
flint n  : 0.322
flint p  : 0.640
ntt32 s  : 0.861
ntt32 l  : 0.910
ntt64 s  : 1.363
ntt64 l  : 1.412
Min_25 s : 0.124
Min_25 l : 0.157
libbf    : 0.634
ntl      : 0.600
ntt test : data = max mod, size = 3, n = 1479725, mod = 100000000003
flint n  : 0.903
flint p  : 1.300
ntt32 l  : 1.808
ntt64 l  : 2.814
Min_25 l : 0.312
libbf    : 1.050
ntl      : 1.243
ntt test : data = max mod, size = 4, n = 1000000, mod = 316227766016779
flint n  : 0.608
flint p  : 0.875
ntt64 l  : 1.405
Min_25 l : 0.140
libbf    : 0.684
ntl      : 0.911

mod = 100019
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.000  0.000  0.016  0.015  0.043  0.047  0.140  0.297
flint p  0.000  0.000  0.016  0.000  0.000  0.016  0.031  0.062  0.141  0.282  0.582
ntt32 s  0.000  0.000  0.016  0.000  0.015  0.031  0.047  0.109  0.209  0.413  0.849
ntt32 l  0.000  0.000  0.016  0.000  0.016  0.042  0.040  0.109  0.221  0.443  0.919
ntt64 s  0.000  0.016  0.000  0.015  0.031  0.053  0.078  0.156  0.326  0.655  1.353
ntt64 l  0.001  0.002  0.006  0.012  0.026  0.055  0.084  0.168  0.363  0.687  1.409
Min_25 s 0.000  0.000  0.000  0.000  0.000  0.015  0.016  0.015  0.032  0.063  0.109
Min_25 l 0.000  0.000  0.016  0.000  0.000  0.015  0.016  0.015  0.031  0.062  0.141
libbf    0.000  0.000  0.000  0.019  0.009  0.021  0.047  0.063  0.141  0.296  0.651
ntl      0.000  0.000  0.000  0.000  0.016  0.016  0.032  0.078  0.157  0.306  0.609
mod = 1000003
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.001  0.002  0.001  0.016  0.031  0.063  0.140  0.312
flint p  0.000  0.000  0.016  0.000  0.000  0.000  0.031  0.054  0.130  0.305  0.597
ntt32 s  0.016  0.000  0.000  0.016  0.015  0.032  0.047  0.109  0.203  0.431  0.843
ntt32 l  0.000  0.000  0.000  0.000  0.016  0.031  0.047  0.109  0.234  0.453  0.922
ntt64 s  0.000  0.000  0.015  0.000  0.016  0.047  0.078  0.157  0.328  0.656  1.328
ntt64 l  0.000  0.000  0.015  0.016  0.015  0.047  0.079  0.172  0.344  0.687  1.421
Min_25 s 0.000  0.000  0.000  0.000  0.000  0.000  0.015  0.016  0.031  0.047  0.125
Min_25 l 0.000  0.000  0.000  0.000  0.015  0.000  0.016  0.016  0.047  0.078  0.141
libbf    0.000  0.000  0.000  0.000  0.016  0.016  0.047  0.062  0.141  0.313  0.625
ntl      0.000  0.000  0.000  0.000  0.015  0.016  0.032  0.063  0.140  0.297  0.609
mod = 1000000007
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.016  0.000  0.015  0.031  0.047  0.094  0.234  0.484
flint p  0.000  0.000  0.000  0.000  0.016  0.015  0.031  0.078  0.172  0.375  0.734
ntt32 l  0.000  0.000  0.000  0.015  0.016  0.047  0.062  0.109  0.234  0.453  0.906
ntt64 l  0.000  0.000  0.000  0.016  0.031  0.063  0.093  0.172  0.343  0.688  1.406
Min_25 l 0.000  0.000  0.016  0.000  0.000  0.016  0.000  0.016  0.047  0.063  0.141
libbf    0.000  0.000  0.000  0.000  0.016  0.015  0.047  0.078  0.156  0.328  0.672
ntl      0.000  0.000  0.000  0.000  0.016  0.015  0.031  0.078  0.141  0.312  0.609
mod = 100000000003
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.000  0.015  0.000  0.015  0.047  0.094  0.297  0.641
flint p  0.000  0.000  0.000  0.000  0.000  0.016  0.031  0.078  0.156  0.422  0.906
ntt32 l  0.000  0.000  0.000  0.016  0.015  0.047  0.062  0.125  0.219  0.453  0.906
ntt64 l  0.000  0.015  0.000  0.016  0.031  0.063  0.093  0.172  0.359  0.703  1.405
Min_25 l 0.000  0.000  0.000  0.000  0.000  0.000  0.016  0.015  0.031  0.078  0.156
libbf    0.000  0.000  0.000  0.000  0.016  0.015  0.047  0.078  0.156  0.312  0.656
ntl      0.000  0.000  0.000  0.000  0.000  0.016  0.047  0.093  0.203  0.438  0.875
mod = 316227766016779
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.016  0.000  0.000  0.000  0.000  0.031  0.047  0.125  0.281  0.624
flint p  0.000  0.000  0.000  0.016  0.000  0.015  0.047  0.093  0.203  0.422  0.891
ntt64 l  0.000  0.015  0.000  0.016  0.031  0.063  0.093  0.172  0.343  0.688  1.422
Min_25 l 0.000  0.000  0.000  0.000  0.000  0.000  0.015  0.016  0.031  0.078  0.156
libbf    0.000  0.000  0.000  0.000  0.016  0.016  0.031  0.062  0.141  0.328  0.672
ntl      0.000  0.000  0.000  0.000  0.015  0.032  0.062  0.109  0.235  0.469  0.953
```

#### Openmp disabled (option "-fopenmp" removed)
```cpp
ntt test : data = random, size = 1, n = 1000000, mod = 100019
flint n  : 0.313
flint p  : 0.562
ntt32 s  : 2.578
ntt32 l  : 3.811
ntt64 s  : 2.140
ntt64 l  : 4.265
Min_25 s : 0.125
Min_25 l : 0.265
libbf    : 0.625
ntl      : 0.578
ntt test : data = random, size = 3, n = 1479725, mod = 100000000003
flint n  : 0.891
flint p  : 1.297
ntt32 l  : 8.139
ntt64 l  : 9.076
Min_25 l : 0.656
libbf    : 1.063
ntl      : 1.281
ntt test : data = random, size = 4, n = 1000000, mod = 316227766016779
flint n  : 0.593
flint p  : 0.875
ntt64 l  : 4.343
Min_25 l : 0.328
libbf    : 0.656
ntl      : 0.906
ntt test : data = max mod, size = 1, n = 999996, mod = 1000003
flint n  : 0.297
flint p  : 0.562
ntt32 s  : 2.578
ntt32 l  : 3.796
ntt64 s  : 2.109
ntt64 l  : 4.234
Min_25 s : 0.125
Min_25 l : 0.266
libbf    : 0.625
ntl      : 0.578
ntt test : data = max mod, size = 3, n = 1479725, mod = 100000000003
flint n  : 0.890
flint p  : 1.296
ntt32 l  : 8.123
ntt64 l  : 9.045
Min_25 l : 0.609
libbf    : 1.062
ntl      : 1.234
ntt test : data = max mod, size = 4, n = 1000000, mod = 316227766016779
flint n  : 0.609
flint p  : 0.859
ntt64 l  : 4.264
Min_25 l : 0.312
libbf    : 0.656
ntl      : 0.890

mod = 100019
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.000  0.000  0.015  0.016  0.031  0.063  0.141  0.297
flint p  0.000  0.000  0.015  0.000  0.000  0.000  0.031  0.063  0.125  0.281  0.594
ntt32 s  0.000  0.000  0.015  0.016  0.031  0.063  0.140  0.265  0.563  1.218  2.577
ntt32 l  0.000  0.016  0.000  0.031  0.047  0.094  0.203  0.407  0.859  1.797  3.812
ntt64 s  0.000  0.000  0.000  0.015  0.032  0.046  0.109  0.234  0.484  1.016  2.156
ntt64 l  0.000  0.016  0.000  0.031  0.047  0.109  0.219  0.453  0.953  2.030  4.280
Min_25 s 0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.015  0.063  0.125
Min_25 l 0.000  0.000  0.000  0.000  0.000  0.000  0.015  0.031  0.063  0.125  0.265
libbf    0.000  0.000  0.000  0.016  0.000  0.016  0.047  0.079  0.140  0.296  0.640
ntl      0.000  0.000  0.000  0.000  0.016  0.015  0.031  0.062  0.141  0.297  0.609
mod = 1000003
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.000  0.016  0.000  0.015  0.031  0.063  0.157  0.313
flint p  0.000  0.000  0.000  0.000  0.015  0.016  0.031  0.062  0.125  0.281  0.578
ntt32 s  0.000  0.000  0.000  0.015  0.031  0.047  0.125  0.281  0.578  1.218  2.640
ntt32 l  0.000  0.016  0.000  0.031  0.047  0.094  0.249  0.578  0.984  1.984  4.140
ntt64 s  0.000  0.000  0.016  0.015  0.016  0.063  0.125  0.249  0.531  1.109  2.327
ntt64 l  0.000  0.000  0.016  0.031  0.047  0.109  0.234  0.500  1.031  -0.079 4.655
Min_25 s 0.000  0.000  0.000  0.000  0.000  0.016  0.016  0.016  0.031  0.063  0.141
Min_25 l 0.000  0.000  0.000  0.015  0.000  0.016  0.016  0.031  0.063  0.141  0.281
libbf    0.000  0.000  0.000  0.000  0.000  0.015  0.047  0.078  0.140  0.313  0.656
ntl      0.000  0.000  0.000  0.016  0.016  0.015  0.031  0.078  0.156  0.329  0.625
mod = 1000000007
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.000  0.015  0.016  0.015  0.047  0.094  0.250  0.468
flint p  0.000  0.000  0.000  0.016  0.000  0.016  0.031  0.078  0.156  0.375  0.781
ntt32 l  0.000  0.000  0.016  0.016  0.047  0.094  0.204  0.438  1.016  1.999  4.374
ntt64 l  0.000  0.015  0.000  0.016  0.062  0.109  0.266  0.499  1.047  2.109  4.343
Min_25 l 0.000  0.000  0.000  0.000  0.000  0.015  0.016  0.047  0.078  0.157  0.312
libbf    0.016  0.000  0.000  0.000  0.016  0.015  0.047  0.078  0.156  0.328  0.672
ntl      0.000  0.000  0.000  0.015  0.000  0.016  0.031  0.062  0.156  0.297  0.609
mod = 100000000003
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.000  0.015  0.016  0.016  0.031  0.094  0.297  0.625
flint p  0.000  0.000  0.016  0.000  0.000  0.015  0.047  0.078  0.156  0.422  0.953
ntt32 l  0.000  0.015  0.000  0.031  0.047  0.094  0.203  0.406  0.859  1.828  3.889
ntt64 l  0.016  0.000  0.016  0.015  0.047  0.094  0.219  0.469  0.969  2.062  4.342
Min_25 l 0.000  0.000  0.000  0.000  0.000  0.000  0.015  0.031  0.078  0.156  0.328
libbf    0.000  0.000  0.000  0.000  0.000  0.015  0.031  0.063  0.140  0.313  0.656
ntl      0.000  0.000  0.000  0.000  0.000  0.016  0.047  0.109  0.203  0.422  0.859
mod = 316227766016779
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.000  0.015  0.016  0.031  0.062  0.141  0.296  0.609
flint p  0.000  0.000  0.016  0.000  0.015  0.016  0.031  0.093  0.203  0.421  0.906
ntt64 l  0.000  0.000  0.000  0.031  0.047  0.109  0.218  0.469  0.969  2.062  4.327
Min_25 l 0.000  0.000  0.000  0.000  0.000  0.000  0.016  0.032  0.062  0.156  0.344
libbf    0.000  0.000  0.000  0.000  0.015  0.031  0.047  0.078  0.157  0.312  0.687
ntl      0.000  0.000  0.000  0.000  0.015  0.031  0.063  0.109  0.219  0.453  0.937
```
